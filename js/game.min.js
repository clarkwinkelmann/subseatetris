/*
	Subsea Tetris
	Clark Winkelmann
	clark.winkelmann@gmail.com
	http://sourceforge.net/p/subseatetris
	Version 4.0.2
*/
eval(function(p,a,c,k,e,r){e=function(c){return(c<a?'':e(parseInt(c/a)))+((c=c%a)>35?String.fromCharCode(c+29):c.toString(36))};if(!''.replace(/^/,String)){while(c--)r[e(c)]=k[c]||e(c);k=[function(e){return r[e]}];e=function(){return'\\w+'};c=1};while(c--)if(k[c])p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c]);return p}('c J=0;c 1p=4E;c X=0;c Y=1;c 2r=0;c 1L=1;c 2N=18;c 1M=4F;c 1B=30;c 3K=15;c 3L=4;c 2s=3;c 2O=7;c 1C=2;c w={24:\'#4G\',25:\'#4H\',26:\'#4I\',28:\'#4J\',29:\'#4K\',2a:\'#4L\',2b:\'#4M\',4N:\'#4O\',1L:\'4P(2P,2P,2P,0.4)\'};c 3M=5;c 3N=10;c 2Q=30;c 2R=3O;c 3P=8;c 3Q=2;c 3R=18;c 3S=0.4Q;c 3T=2;c 2S=k.4R(\'3U\')[0];c 2c=k.l(\'4S\');c 2T=k.l(\'4T\');c 2U=k.l(\'4U\');c 2V=k.l(\'4V\');c 1N=k.l(\'4W\');c 2W=k.l(\'4X\');c 1O=k.l(\'4Y\');c 1q=k.l(\'4Z\');c 2X=k.l(\'51\');c 2Y=k.l(\'52\');c 2Z=k.l(\'53\');c 31=k.l(\'54\');c 32=k.l(\'55\');c 2d=k.l(\'56\');c 33=k.l(\'57\');c 34=k.l(\'1D\');c 2t=k.l(\'58\');c 35=k.l(\'59\');c 1P=f;c 2e=f;c A=g D();c F=g D();c I=g D();c 12=g D();c 19=g D();c 1a=g D(J,J,J);c B=1;c K=1;c U=1;c 2u=0.3;c 1Q=2Q;c 1f=0;c V=1;c R=-1;c 16=0;c 1R=0;c 1S=u;c 1r=u;c 1T=u;c 1g=J;c 2v=f;c 2w=f;c 36=J;c 3a=0;c 2f=J;c 1b=f;c 1c=f;c 2g=f;c 1h=f;c 1i={x:0,y:0};c 2x=3;c 2h=5;c 5a=0;c 5b=2;c 3b=50;c 1y=f;c 1E=f;c W={L:0,1s:0};c 2y=0;c 1z=0;c 2i={L:5c,1s:5d};c 1j=0;c 3c={L:3d,1s:3d};c 1U=50;c 1F=50;c O=10;c 2z=g D();1k.3V=(n(){Z 1k.5e||1k.5f||1k.5g||1k.5h||1k.5i||n(3W){1k.1l(3W,5j/60)}})();n 3e(1t){c 3f=1;d(1t[0]==="-"){3f=-1;1t=1t.5k(1,1t.14-1)}Z n(a,b){c 3X=(a[1t]<b[1t])?-1:(a[1t]>b[1t])?1:0;Z 3X*3f}}c 2A;n 17(1G,2j,2k,1m){d(2j==2l){2j=u}d(2k==2l){2k=u}d(1m==2l){1m=-1}5l(2A);d(1m==-1){3g=\'\';H(i=0;i<1G.14;i++){3g+=\'<3Y E="2B\'+i+\'">\'+1G[i]+\'</3Y>\'}2d.P=3g;2d.h.2m=\'5m%\'}H(i S 1G){d(2k){d(i==1m){k.l(\'2B\'+i).h.3h=\'5n\'}v d(i>1m-2&&i<1m+2){k.l(\'2B\'+i).h.3h=\'5o\'}v{k.l(\'2B\'+i).h.3h=\'5p\'}}}1m++;d(1m<=1G.14+1){d(1G.14<=10){c 3i=18}v{c 3i=3Z}k.l(\'1D-3j\').h.1V=\'3k\';k.l(\'1D-3l\').h.1V=\'3m\';2A=1l(n(){17(1G,2j,2k,1m)},3i)}v d(2j){2A=1l(n(){2d.h.2m=\'18%\'},5q)}}n 3n(){34.h.Q=\'0\';33.h.Q=\'18%\';1r=u}n 41(){k.l(\'1D-3j\').h.1V=\'3m\';k.l(\'1D-3l\').h.1V=\'3k\';3n()}n 42(){33.h.Q=\'0\';34.h.Q=\'-18%\'}n 43(){d(!1r&&!2e){d(1P){3o();2t.h.Q=\'0\';35.P=\'5r\'}v{1P=u;17(5s,f);2t.h.Q=\'5t\';35.P=\'<2C>&#5u;</2C>\'}}}n 3o(){2e=u;1l(n(){17(\'3\',f,f)},5v);1l(n(){17(\'2\',f,f)},44);1l(n(){17(\'1\',f,f)},45);1l(n(){17(\'5w !\',u,f);1P=f;1r=f;2e=f},5x)}k.5y=n(e){2D(e.46){G 37:1b=u;1c=f;C;G 39:1c=u;1b=f;C;G 38:2g=u;Z f;C;G 40:1h=u;Z f;C;G 27:43();C}};k.5z=n(e){2D(e.46){G 37:1b=f;C;G 39:1c=f;C;G 38:2g=f;C;G 40:1h=f;C;G 13:d(1r){47()}C;G 5A:d(!1r){41();1P=u}C}};k.2E("5B",48,f);k.2E("5C",49,u);k.2E("5D",3p,f);k.3U.2E("5E",3p,f);n 48(e){d(!1b&&!1c&&!1h){d(e.1d[0].1H<W.L/2-3b){1y=u;1E=f}v d(e.1d[0].1H>W.L/2+3b){1E=u;1y=f}v{1y=f;1E=f}}Z f}n 49(e){d(e.1d[0].2F<1i.y+2h&&e.1d[0].2F>1i.y-2h){d(e.1d[0].1H>1i.x+2x){1c=u;1b=f}v d(e.1d[0].1H<1i.x-2x){1b=u;1c=f}v{1b=f;1c=f}}v{1b=f;1c=f}d(e.1d[0].1H<1i.x+2h&&e.1d[0].1H>1i.x-2h){d(e.1d[0].2F>1i.y+2x){1h=u}v{1h=f}}v{1h=f}1i.x=e.1d[0].1H;1i.y=e.1d[0].2F}n 3p(){1b=f;1c=f;1h=f;1y=f;1E=f}n p(M,4a,4b,m){d(m==2l){m=2r}d(m==1L){M=w.1L}2G.M=M;2G.x=4a;2G.y=4b;2G.m=m}n 1W(4c,E,4d){d(k.l(E)==5F){c 4e=k.4f(\'2C\');4c.4g(4e).4h(\'E\',E);c 4i=k.4f(\'2C\');k.l(E).4g(4i);k.l(E).4h(\'5G\',\'3q\');k.l(E).h.5H=2u+\'s\';k.l(E).h.5I=2u+\'s\';k.l(E).h.5J=4d}}n 2n(E,1X,1Y){k.l(E).h.1u=1X*B+(K/2-1)*B+1C+\'r\';k.l(E).h.Q=(U-1Y-1)*B+1C+\'r\';k.l(E).h.1v=B-1C*2+\'r\';k.l(E).h.1Z=B-1C*2+\'r\';k.l(E).h.4j=B/10+\'r\'}n 4k(E,5K,1X,1Y){k.l(E).h.1u=1X*1B+\'r\';k.l(E).h.Q=(3L-1Y)*1B+\'r\';k.l(E).h.1v=1B-1C*2+\'r\';k.l(E).h.1Z=1B-1C*2+\'r\';k.l(E).h.4j=1B/10+\'r\'}n 2H(){H(i S A){1W(1q,\'3q-\'+i,A[i].M);2n(\'3q-\'+i,A[i].x,A[i].y)}H(i S F){1W(1q,\'4l-\'+i,F[i].M);2n(\'4l-\'+i,F[i].x,F[i].y)}H(i S I){1W(1q,\'4m-\'+i,I[i].M);2n(\'4m-\'+i,I[i].x,I[i].y)}H(i S 12){1W(1q,\'4n-\'+i,12[i].M);2n(\'4n-\'+i,12[i].x,12[i].y)}}n 1I(){1q.P=\'\'}n 3r(){H(i=0;i<2s;i++){k.l(\'1J-\'+i).P="";H(j=0;j<19[i].14;j++){1W(k.l(\'1J-\'+i),\'1J-\'+i+\'-\'+j,19[i][j].M);4k(\'1J-\'+i+\'-\'+j,19[i][j].M,19[i][j].x,19[i][j].y)}}}n 4o(E,m){d(m==2l){m=2r}z=g D();2D(E){G 0:z.o(g p(w.24,0,2,m));z.o(g p(w.24,0,1,m));z.o(g p(w.24,0,0,m));z.o(g p(w.24,0,-1,m));C;G 1:z.o(g p(w.25,0,0,m));z.o(g p(w.25,0,1,m));z.o(g p(w.25,1,0,m));z.o(g p(w.25,1,1,m));C;G 2:z.o(g p(w.26,-1,0,m));z.o(g p(w.26,0,0,m));z.o(g p(w.26,1,0,m));z.o(g p(w.26,0,1,m));C;G 3:z.o(g p(w.28,0,1,m));z.o(g p(w.28,0,0,m));z.o(g p(w.28,0,-1,m));z.o(g p(w.28,1,-1,m));C;G 4:z.o(g p(w.29,0,1,m));z.o(g p(w.29,0,0,m));z.o(g p(w.29,0,-1,m));z.o(g p(w.29,-1,-1,m));C;G 5:z.o(g p(w.2a,0,0,m));z.o(g p(w.2a,0,-1,m));z.o(g p(w.2a,1,0,m));z.o(g p(w.2a,1,1,m));C;G 6:z.o(g p(w.2b,0,0,m));z.o(g p(w.2b,0,-1,m));z.o(g p(w.2b,-1,0,m));z.o(g p(w.2b,-1,1,m));C}Z z}n 4p(){c 2I;c m=2r;5L{2I=T.1e(T.3s()*2O)}3t(2I>2O-1);d(1g==J&&36==J){d(V>=3Q&&T.1e(T.3s()*3R)==0){m=1L;1a[2s-1]=1M}}Z 4o(2I,m)}n 1A(1X,1Y,t){c N=g D();H(i S t){N.o(g p(t[i].M,t[i].x+1X,t[i].y+1Y,t[i].m))}Z N}n 3u(4q,3v,t){c 20=0;H(i S t){d(4q==X){d(t[i].x>3v){20++}v{20--}}v{d(t[i].y>3v){20++}v{20--}}}Z 20}n 3w(3x,t){c 2o=1p;c 2p=1p;c 1w=1p;c 1x=1p;H(i S t){d(t[i].x>2o||2o==1p){2o=t[i].x}d(t[i].x<2p||2p==1p){2p=t[i].x}d(t[i].y>1w||1w==1p){1w=t[i].y}d(t[i].y<1x||1x==1p){1x=t[i].y}}1n=(2p+2o)/2;1o=(1x+1w)/2;d(1n!=T.1e(1n)){d(3u(X,1n,t)>0){1n=T.4r(1n)}v{1n=T.1e(1n)}}d(1o!=T.1e(1o)){d(3u(Y,1o,t)>0){1o=T.4r(1o)}v{1o=T.1e(1o)}}c N=g D();H(i S t){c 4s=(t[i].y-1o)*3x+1n;c 4t=(t[i].x-1n)*3x*-1+1o;N.o(g p(t[i].M,4s,4t,t[i].m))}Z N}n 3y(){W.L=1k.5M;W.1s=1k.5N;2S.h.1v=W.L+\'r\';2S.h.1Z=W.1s+\'r\';d(W.L<=44){2i={L:0,1s:0};1U=10;1F=0;1j=3Z;1B=3K}3z()}1k.5O=3y;n 3z(){d((W.L-1U*4-2i.L*2)/K<(W.1s-1U*3-1j)/U){B=(W.L-1U*4-2i.L*2)/K}v{B=(W.1s-1U*3-1j)/U}2c.h.1v=K*B+O*2+\'r\';2c.h.1Z=U*B+O*2+\'r\';d(1j>0){2V.h.1v=K*B+O*2+\'r\'}1q.h.Q=O+\'r\';1q.h.1u=O+\'r\';1N.h.1v=(K-1)*B+\'r\';1N.h.1Z=(U-1)*B+\'r\';1N.h.5P=B+\'r\';1N.h.Q=O+B/2+\'r\';1N.h.1u=O+B/2+\'r\';2W.h.Q=(U*B+O*2-3c.1s)/2+\'r\';2W.h.1u=(K*B+O*2-3c.L)/2+\'r\';d(1j==0){2T.h.Q=1F+1j+\'r\';2U.h.Q=1F+1j+\'r\';2T.h.1u=(W.L-K*B-O*2)/2-(2i.L+1F)+\'r\';2U.h.1u=(W.L-K*B-O*2)/2+K*B+O*2+1F+\'r\'}2c.h.Q=1F+1j+\'r\';2c.h.1u=(W.L-K*B-O*2)/2+\'r\';d(1j>0){2V.h.1u=(W.L-K*B-O*2)/2+\'r\'}2H();1O.h.1v=(K*B+O*2)*2+\'r\';1O.h.1Z=(U*B+O*2)*2+\'r\';2y=U*B+O*2;d(1z!=0){1O.h.Q=2y+\'r\'}}n 3A(4u,4v){K=4u;U=4v;3z();2H();2z=g D();H(i=0;i<U;i++){2z.o(0)}}n 47(){A=g D();F=g D();I=g D();12=g D();19=g D();1a[0]=J;1a[1]=J;1a[2]=J;1Q=2Q;1f=0;V=1;R=-1;16=0;1R=0;1S=u;1r=u;2e=f;1g=J;36=J;1q.P=\'\';k.l(\'1J-0\').P=\'\';k.l(\'1J-1\').P=\'\';k.l(\'1J-2\').P=\'\';2t.h.Q=\'0\';2d.h.2m=\'18%\';2Z.P=\'0\';31.P=\'0\';32.P=\'1\';3A(8,10);3B();3r();1l(n(){42()},5Q);1l(n(){3o()},5R)}n 4w(){1r=u;17(5S,f);k.l(\'1D-3j\').h.1V=\'3k\';k.l(\'1D-3l\').h.1V=\'3m\';k.l(\'5T\').P=16;k.l(\'5U\').P=1R;k.l(\'5V\').P=V;c 21=4x();c 3C=g 5W(16,g 5X());d(16>21[9].5Y){21.o(3C);5Z(21);21=4x()}61(21,3C);1l(n(){3n()},3O)}n 4y(){1S=f;62=U-A[A.14-1].y;1O.h.Q=\'0\';R=1;1z=1f+2R;12=A;A=g D();1I();1g=2N}n 63(q){c N=g D();d(R<0){N=q.4z(3e(\'y\'))}v{N=q.4z(3e(\'-y\'))}Z N}n 4A(t,4B){c N=g D();H(i S t){d(t[i].m!=4B){N.o(g p(t[i].M,t[i].x,t[i].y,t[i].m))}}Z N}n 3D(q){c 3E=u;c 1x,1w;d(R<0){1x=0;1w=U+4}v{1x=-5;1w=U-1}H(i S q){d(q[i].x>T.1e(K/2)||q[i].x<-T.1e(K/2)+1||q[i].y<1x||q[i].y>1w){3E=f;C}}Z 3E}n 22(q){c 23=u;d(3D(q)){d(1g==1M){23=u}v{H(i S q){H(j S A){d(A[j].x==q[i].x&&A[j].y==q[i].y){23=f;C}}H(j S I){d(I[j].x==q[i].x&&I[j].y==q[i].y){23=f;C}}}}}v{23=f}Z 23}n 4C(3F,q,R){N=g D();H(i S q){d(q[i].y>3F){d(R<0){N.o(g p(q[i].M,q[i].x,q[i].y-1,q[i].m))}v{N.o(g p(q[i].M,q[i].x,q[i].y,q[i].m))}}v d(q[i].y<3F){d(R<0){N.o(g p(q[i].M,q[i].x,q[i].y,q[i].m))}v{N.o(g p(q[i].M,q[i].x,q[i].y+1,q[i].m))}}}Z N}n 3B(){3t(19.14<=2s){19.o(4p(V))}}n 3G(){d(!1P&&!1r){1f++;d(1f%3M==0){d(2f!=J){A=4A(A,2f);2f=J;1I()}d(2g||1y||1E){c 2J=1;d(1y){2J=-1}d(22(3w(2J,F))){F=3w(2J,F);1T=f;2v=u;2g=f;1y=f;1E=f}}2q=0;c 2K=f;d(1b){2q=-1;2K=u}d(1c){2q=1;2K=u}d(2K){d(22(1A(2q,0,F))){F=1A(2q,0,F);1T=f;2w=u}}}d(1f%T.1e(1Q)==0||(1h&&1f%T.1e(1Q/5)==0)){d(F.14<1&&1S){d(1a[0]==1M){17(64);1g=1M}1a[0]=1a[1];1a[1]=1a[2];1a[2]=J;3B();c 2L;d(R<0){2L=U+1}v{2L=-2}F=1A(0,2L,19[0]);1T=u;19.65();3r()}d(I.14>0){c i=0;3t(i<I.14){c 3H=g D();3H.o(g p(I[i].M,I[i].x,I[i].y+R,I[i].m));d(22(3H)){I[i].y+=R;i++}v{A.o(g p(I[i].M,I[i].x,I[i].y,I[i].m));I.66(i,1);1I()}}}d(12.14>0){d(3D(1A(0,R,12))){12=1A(0,R,12)}v{A=A.4D(12);12=g D();1S=u}}d(22(1A(0,R,F))){F=1A(0,R,F);1T=f;d(1h){16+=V}}v d(!2w&&!2v){d(1T){4w()}d(1g==1M){1g=J;H(i S F){c 3I=g D();3I.o(F[i]);d(22(3I)){A.o(F[i])}}2f=1L}v{A=A.4D(F)}F=g D();1I()}2v=f;2w=f;c 2M=2z.67(0);H(i S A){2M[A[i].y]+=1}c 1K=0;H(i=2M.14-1;i>=0;i--){d(2M[i]>=K){A=4C(i,A,R);1K++;1I()}}d(1K>0){1R+=1K;c 3J=1K;d(3a==4&&1K==4){3J=8}3a=1K;2D(3J){G 1:16+=40*V;C;G 2:16+=18*V;C;G 3:16+=3d*V;C;G 4:16+=45*V;17(\'A !\');C;G 8:16+=68*V;17(\'69-A !\');C}d(1R/3N>=V){V++;1Q*=3S;d(V%3T==1){3A(K+2,U+1)}d(T.1e(T.3s()*3P)==0){4y()}17(6a+\' \'+V+\' !\');2u=T.6b(10/11*1Q)/18}}d(1f>=1z&&1z!=0&&F.14<1){1S=f;1z=0;1O.h.Q=2y+\'r\';R=-1;12=A;A=g D();1I();1g=J}d(1g==2N){2X.h.2m=\'0\';d(1z>=1f){2Y.h.1v=((1z-1f)/2R)*18+\'%\'}}v{2X.h.2m=\'-6c\';2Y.h.1v=\'18%\'}2Z.P=16;31.P=1R;32.P=V}2H()}3V(3G)}3y();3G();',62,385,'||||||||||||var|if||false|new|style|||document|getElementById|Type|function|push|TetriStone|Table|px||table|true|else|COLOR|||New|Tetris|Ratio|break|Array|id|TetrisFall|case|for|TetrisGravity|NONE|GameWidth|WIDTH|Couleur|Table2|PADDINGGAMEZONE|innerHTML|top|Gravity|in|Math|GameHeight|Niveau|WINDOW|||return|||TetrisFloat||length||Score|sendMessage|100|NextTetriminos|NextPowers|LEFT_PRESSED|RIGHT_PRESSED|targetTouches|floor|Frame|PowerInAction|DOWN_PRESSED|PreviousPos|TOPBARHEIGHT|window|setTimeout|nombre|CenterX|CenterY|DEFAULT|TETRIMINOS|PartieFinie|HEIGHT|property|left|width|MaxY|MinY|ROTATE_LEFT|AquaTime|moveTetriminos|TAILLE_NEXTTETRIMINOS|MARGETETRIMINOS|home|ROTATE_RIGHT|MARGEGAMEZONE|texte|pageX|clearGameZone|nexttetrimino|NbreLignes|GHOST|GHOSTPOWER|QUARRES|AQUA|EnPause|TetrisFrames|Lignes|TetriSpawn|TetriFallDontMove|RESIZEMARGE|display|createTetriDiv|posX|posY|height|Nbre|HighScores|isTetriminoFree|Peut|TETRIMINO0|TETRIMINO1|TETRIMINO2||TETRIMINO3|TETRIMINO4|TETRIMINO5|TETRIMINO6|GAMEZONE|MESSAGE|WaitPause|DeleteTetriStonesTypeNextFrame|UP_PRESSED|TOUCH_TOLERANCE|SIDEBAR|hide|anim|undefined|bottom|drawTetriStone|MaxX|MinX|NextPositionX|NORMAL|NBRE_NEXTTETRIMINOS|NEWGAME|TetriStoneTransition|InRotation|InMoveX|TOUCH_ERREUR|ZoneHeight|TotalLigneBlank|MessageTimeOut|messagelettre|div|switch|addEventListener|pageY|this|drawTetriminos|NombreHasard|Angle|MoveX|PositionDepart|TotalLigne|AQUAPOWER|NBRE_TETRIMINOS|255|TETRISFRAMES_START|AQUA_FRAMES|BODY|SIDEBAR1|SIDEBAR2|TOPBAR|LOGODIV|TIMER|PROGRESS|SCORE||LINES|LEVEL|GAME|HOME|PAUSE|StartPower||||LastNbreLignes|TOUCH_SPACE_CENTER|LOGO|300|dynamicSort|sortOrder|MessageDiv|fontSize|TimeOut|start|none|end|block|afficheMenu|start321|touchUp|tetrimino|drawNextTetriminos|random|while|getNbreTetriminosFromCentre|centre|rotateTetriminos|angle|resizeWindow|resizeGameZone|changeGameSize|tirerNextTetriminos|MonScore|isTetriminoInZone|Valide|Ligne|Game|TetriTable|PieceSolitaire|LignesToScore|TAILLE_NEXTTETRIMINOS_MOBILE|MAX_X_NEXTTETRIMINOS|REFRESHFRAMES|LIGNES_PAR_NIVEAU|3000|AQUA_RISQUE|GHOST_LEVEL_MIN|GHOST_RISQUE|FACTEUR_VITESSE_LEVEL|CHANGE_SIZE_LEVELS|body|requestAnimFrame|callback|result|span|80||nouvellePartie|afficheGame|setPause|800|1200|keyCode|startPartie|touchDown|touchMove|PosX|PosY|emplacement|couleur|newdiv|createElement|appendChild|setAttribute|newdiv2|borderRadius|drawNextTetriStone|tetriminofall|tetriminogravity|tetriminofloat|getTetrimino|getRandomTetrimino|XouY|ceil|NewX|NewY|Width|Height|finPartie|getScores|startAqua|sort|deleteTetriStonesType|typ|supprimeLigne|concat|999999|101|00FDFF|FFFF00|FA15FA|E0872E|0000FF|FF0000|00FF00|TETRIMINO100|2B1D79|rgba|95|getElementsByTagName|gamezone|sidebar1|sidebar2|topbar|quarres|logo|aqua|tetriminos||timer|progress|score|lines|level|message|game|newgame|pause|NextTouchFrame|TOUCH_FRAMES|200|600|requestAnimationFrame|webkitRequestAnimationFrame|mozRequestAnimationFrame|oRequestAnimationFrame|msRequestAnimationFrame|1000|substr|clearTimeout|70|3em|2em|1em|2000|II|T_Pause|100px|9654|400|Go|1600|onkeydown|onkeyup|78|touchstart|touchmove|touchend|touchcancel|null|class|webkitTransition|transition|background|Background|do|innerWidth|innerHeight|onresize|backgroundSize|500|1500|T_EndOfGame|scorefinal|linesfinal|levelfinal|HighScore|Date|Points|setScores||buildTableauHighScores|TetriSpawnWait|sortGravity|T_Ghost|shift|splice|slice|4000|Mega|T_Level|round|30px'.split('|'),0,{}))
